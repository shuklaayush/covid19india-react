{"version":3,"sources":["hooks/useIsVisible.js","hooks/useStickySWR.js","components/Home.js"],"names":["OPTIONS","root","rootMargin","threshold","useIsVisible","elementRef","useState","isVisible","setIsVisible","useEffect","current","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","unobserve","observe","useStickySWR","key","fetcher","swrOptions","options","setOptions","args","useSWR","data","isValidating","error","rest","useUpdateEffect","produce","draftOptions","initialData","Actions","lazy","Footer","Level","LevelVaccinated","MapExplorer","MapSwitcher","Minigraphs","Search","StateHeader","Table","TimeseriesExplorer","Home","stateCode","districtName","regionHighlighted","setRegionHighlighted","useLocalStorage","anchor","setAnchor","expandTable","setExpandTable","useSessionStorage","mapStatistic","setMapStatistic","date","setDate","location","useLocation","timeseries","API_ROOT_URL","revalidateOnMount","refreshInterval","homeRightElement","useRef","width","useWindowSize","hideDistrictData","GOSPEL_DATE","hideVaccinated","getStatistic","Helmet","name","content","className","classnames","expanded","fallback","style","minHeight","dates","Object","keys","position","marginTop","height","ref","hash","stickied"],"mappings":"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","file":"static/js/31.a32f7d91.chunk.js","sourcesContent":["import {useState, useEffect} from 'react';\n\nconst OPTIONS = {\n  root: null,\n  rootMargin: '0px 0px 0px 0px',\n  threshold: 0,\n};\n\nconst useIsVisible = (elementRef) => {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    if (elementRef.current) {\n      const observer = new IntersectionObserver((entries, observer) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            setIsVisible(true);\n            observer.unobserve(elementRef.current);\n          }\n        });\n      }, OPTIONS);\n      observer.observe(elementRef.current);\n    }\n  }, [elementRef]);\n\n  return isVisible;\n};\n\nexport default useIsVisible;\n","import produce from 'immer';\nimport {useState} from 'react';\nimport {useUpdateEffect} from 'react-use';\nimport useSWR from 'swr';\n\nexport function useStickySWR(key, fetcher, swrOptions, ...args) {\n  const [options, setOptions] = useState(swrOptions);\n\n  const {data, isValidating, error, ...rest} = useSWR(\n    key,\n    fetcher,\n    options,\n    ...args\n  );\n\n  useUpdateEffect(() => {\n    setOptions(\n      produce(options, (draftOptions) => {\n        draftOptions.initialData = data;\n      })\n    );\n  }, [data]);\n\n  return {\n    ...rest,\n    isValidating,\n    error,\n    data,\n  };\n}\n\nexport default useStickySWR;\n","import {API_ROOT_URL, GOSPEL_DATE} from '../constants';\nimport useIsVisible from '../hooks/useIsVisible';\nimport useStickySWR from '../hooks/useStickySWR';\nimport {fetcher, getStatistic} from '../utils/commonFunctions';\n\nimport classnames from 'classnames';\nimport {useState, useRef, lazy, Suspense} from 'react';\nimport {Helmet} from 'react-helmet';\nimport {useLocation} from 'react-router-dom';\nimport {useLocalStorage, useSessionStorage, useWindowSize} from 'react-use';\n\nconst Actions = lazy(() => import('./Actions'));\nconst Footer = lazy(() => import('./Footer'));\nconst Level = lazy(() => import('./Level'));\nconst LevelVaccinated = lazy(() => import('./LevelVaccinated'));\nconst MapExplorer = lazy(() => import('./MapExplorer'));\nconst MapSwitcher = lazy(() => import('./MapSwitcher'));\nconst Minigraphs = lazy(() => import('./Minigraphs'));\nconst Search = lazy(() => import('./Search'));\nconst StateHeader = lazy(() => import('./StateHeader'));\nconst Table = lazy(() => import('./Table'));\nconst TimeseriesExplorer = lazy(() => import('./TimeseriesExplorer'));\n\nfunction Home() {\n  const [regionHighlighted, setRegionHighlighted] = useState({\n    stateCode: 'TT',\n    districtName: null,\n  });\n\n  const [anchor, setAnchor] = useLocalStorage('anchor', null);\n  const [expandTable, setExpandTable] = useLocalStorage('expandTable', false);\n  const [mapStatistic, setMapStatistic] = useSessionStorage(\n    'mapStatistic',\n    'active'\n  );\n  const [date, setDate] = useState('');\n  const location = useLocation();\n\n  const {data: timeseries} = useStickySWR(\n    `${API_ROOT_URL}/timeseries.min.json`,\n    fetcher,\n    {\n      revalidateOnMount: true,\n      refreshInterval: 100000,\n    }\n  );\n\n  const {data} = useStickySWR(\n    `${API_ROOT_URL}/data${date ? `-${date}` : ''}.min.json`,\n    fetcher,\n    {\n      revalidateOnMount: true,\n      refreshInterval: 100000,\n    }\n  );\n\n  const homeRightElement = useRef();\n  const isVisible = useIsVisible(homeRightElement);\n  const {width} = useWindowSize();\n\n  const hideDistrictData = date !== '' && date < GOSPEL_DATE;\n  const hideVaccinated =\n    getStatistic(data?.['TT'], 'total', 'vaccinated') === 0;\n\n  return (\n    <>\n      <Helmet>\n        <title>Coronavirus Outbreak in India - covid19india.org</title>\n        <meta\n          name=\"title\"\n          content=\"Coronavirus Outbreak in India: Latest Map and Case Count\"\n        />\n      </Helmet>\n\n      <div className=\"Home\">\n        <div className={classnames('home-left', {expanded: expandTable})}>\n          <div className=\"header\">\n            <Suspense fallback={<div />}>\n              <Search />\n            </Suspense>\n\n            {timeseries && (\n              <Suspense fallback={<div style={{minHeight: '56px'}} />}>\n                <Actions\n                  {...{\n                    date,\n                    setDate,\n                    dates: Object.keys(timeseries['TT']?.dates),\n                  }}\n                />\n              </Suspense>\n            )}\n          </div>\n\n          <div style={{position: 'relative', marginTop: '1rem'}}>\n            {data && (\n              <Suspense fallback={<div style={{height: '50rem'}} />}>\n                {width > 769 && !expandTable && (\n                  <MapSwitcher {...{mapStatistic, setMapStatistic}} />\n                )}\n                <Level data={data['TT']} />\n              </Suspense>\n            )}\n\n            {timeseries && (\n              <Suspense fallback={<div style={{height: '50rem'}} />}>\n                <Minigraphs timeseries={timeseries['TT']?.dates} {...{date}} />\n              </Suspense>\n            )}\n          </div>\n\n          {!hideVaccinated && <LevelVaccinated data={data['TT']} />}\n\n          {data && (\n            <Suspense fallback={<div style={{height: '60rem'}} />}>\n              <Table\n                {...{\n                  data,\n                  regionHighlighted,\n                  setRegionHighlighted,\n                  expandTable,\n                  setExpandTable,\n                  hideDistrictData,\n                  hideVaccinated,\n                }}\n              />\n            </Suspense>\n          )}\n        </div>\n\n        <div\n          className={classnames('home-right', {expanded: expandTable})}\n          ref={homeRightElement}\n        >\n          {(isVisible || location.hash) && (\n            <>\n              {data && (\n                <div\n                  className={classnames('map-container', {\n                    expanded: expandTable,\n                    stickied:\n                      anchor === 'mapexplorer' || (expandTable && width > 769),\n                  })}\n                >\n                  <Suspense fallback={<div style={{height: '50rem'}} />}>\n                    <StateHeader data={data['TT']} stateCode={'TT'} />\n                    <MapExplorer\n                      stateCode=\"TT\"\n                      {...{date, data}}\n                      {...{mapStatistic, setMapStatistic}}\n                      {...{regionHighlighted, setRegionHighlighted}}\n                      {...{anchor, setAnchor}}\n                      {...{expandTable, hideDistrictData}}\n                    />\n                  </Suspense>\n                </div>\n              )}\n\n              {timeseries && (\n                <Suspense fallback={<div style={{height: '50rem'}} />}>\n                  <TimeseriesExplorer\n                    stateCode=\"TT\"\n                    {...{\n                      timeseries,\n                      date,\n                      regionHighlighted,\n                      setRegionHighlighted,\n                      anchor,\n                      setAnchor,\n                      expandTable,\n                      hideVaccinated,\n                    }}\n                  />\n                </Suspense>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n\n      {isVisible && (\n        <Suspense fallback={<div />}>\n          <Footer />\n        </Suspense>\n      )}\n    </>\n  );\n}\n\nexport default Home;\n"],"sourceRoot":""}